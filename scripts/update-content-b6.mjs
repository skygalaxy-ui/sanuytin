import { createClient } from '@supabase/supabase-js';
const sb = createClient('https://ecipdcojedkbrlggaqja.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjaXBkY29qZWRrYnJsZ2dhcWphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NjEwMTQsImV4cCI6MjA4NTIzNzAxNH0.4tWrl8px93O64ca9WrxOGVNBZpeTQEpNHwWCdlPQHkE');

const extras = {
    71: `<h3>Weighted Moving Average (WMA)</h3><p>NgoÃ i SMA vÃ  EMA, WMA cÅ©ng Ä‘Ã¡ng xem xÃ©t. WMA cho trá»ng sá»‘ cao hÆ¡n cho dá»¯ liá»‡u gáº§n nháº¥t, tÆ°Æ¡ng tá»± EMA nhÆ°ng tÃ­nh toÃ¡n khÃ¡c. Trong thá»±c táº¿, EMA phá»• biáº¿n hÆ¡n WMA vÃ¬ cÃ³ máº·t trÃªn táº¥t cáº£ ná»n táº£ng giao dá»‹ch. WMA chá»§ yáº¿u dÃ¹ng trong cÃ¡c há»‡ thá»‘ng giao dá»‹ch tá»± Ä‘á»™ng (EA) nÆ¡i cáº§n tinh chá»‰nh sensitivity.</p>`,
    74: `<h3>Swap vÃ  chiáº¿n lÆ°á»£c dÃ i háº¡n</h3><p>Äá»‘i vá»›i position trader giá»¯ lá»‡nh hÃ ng tuáº§n Ä‘áº¿n hÃ ng thÃ¡ng, swap lÃ  chi phÃ­ Ä‘Ã¡ng ká»ƒ. Má»™t lá»‡nh Buy EUR/USD 1 lot giá»¯ 30 ngÃ y vá»›i swap -$6.5/ngÃ y sáº½ máº¥t <strong>$195 phÃ­ swap</strong>. Do Ä‘Ã³, position trader cáº§n tÃ­nh swap vÃ o plan trÆ°á»›c khi má»Ÿ lá»‡nh. Náº¿u swap Ã¢m quÃ¡ lá»›n, cÃ¢n nháº¯c dÃ¹ng tÃ i khoáº£n swap-free hoáº·c chuyá»ƒn sang cáº·p tiá»n cÃ³ swap tháº¥p hÆ¡n.</p>`,
    76: `<h3>Káº¿t luáº­n cuá»‘i: Thá»­ trÆ°á»›c khi chá»n</h3><p>CÃ¡ch tá»‘t nháº¥t lÃ  má»Ÿ tÃ i khoáº£n demo Cáº¢ HAI sÃ n, trade song song 2 tuáº§n. So sÃ¡nh: tá»‘c Ä‘á»™ khá»›p lá»‡nh, spread thá»±c táº¿ vÃ o cÃ¡c khung giá» khÃ¡c nhau, tá»‘c Ä‘á»™ náº¡p/rÃºt tiá»n, vÃ  cháº¥t lÆ°á»£ng há»— trá»£ khÃ¡ch hÃ ng. Káº¿t quáº£ thá»±c táº¿ sáº½ cho báº¡n cÃ¢u tráº£ lá»i chÃ­nh xÃ¡c hÆ¡n báº¥t ká»³ bÃ i review nÃ o.</p>`,
    77: `<h3>BB trÃªn nhiá»u Timeframe</h3><p>Multi-Timeframe BB Analysis: Khi BB Squeeze xuáº¥t hiá»‡n Ä‘á»“ng thá»i trÃªn H4 vÃ  D1, breakout sáº½ cá»±c ká»³ máº¡nh. NgÆ°á»£c láº¡i, náº¿u chá»‰ Squeeze trÃªn M15 nhÆ°ng D1 Ä‘ang trend máº¡nh â†’ Squeeze M15 cÃ³ thá»ƒ chá»‰ lÃ  "false alarm". LuÃ´n check BB trÃªn timeframe lá»›n trÆ°á»›c Ä‘á»ƒ xÃ¡c nháº­n context.</p>`,
    78: `<h3>Auto Fibonacci trÃªn TradingView</h3><p>TradingView cÃ³ indicator "Auto Fib Retracement" tá»± Ä‘á»™ng váº½ Fibonacci dá»±a trÃªn swing gáº§n nháº¥t. Tuy nhiÃªn, váº½ thá»§ cÃ´ng váº«n chÃ­nh xÃ¡c hÆ¡n vÃ¬ báº¡n cÃ³ thá»ƒ chá»n swing phÃ¹ há»£p nháº¥t. Máº¹o: overlay 2-3 Fibonacci tá»« cÃ¡c swing khÃ¡c nhau, vÃ¹ng nÃ o cÃ³ nhiá»u má»©c Fibo trÃ¹ng nhau â†’ Ä‘Ã³ lÃ  S/R cá»±c máº¡nh. ÄÃ¢y chÃ­nh lÃ  ká»¹ thuáº­t Fibonacci Cluster mÃ  institutional trader thÆ°á»ng dÃ¹ng.</p>`,
    79: `<h3>Káº¿t há»£p Price Action vá»›i Volume</h3><p>Volume xÃ¡c nháº­n tÃ­nh há»£p lá»‡ cá»§a Price Action. Pin Bar táº¡i S/R nhÆ°ng volume tháº¥p â†’ tÃ­n hiá»‡u yáº¿u. Pin Bar kÃ¨m volume spike â†’ tÃ­n hiá»‡u ráº¥t máº¡nh. Engulfing kÃ¨m volume cao hÆ¡n trung bÃ¬nh 50% â†’ xÃ¡c suáº¥t tháº¯ng cao. TrÃªn Forex, volume chá»‰ lÃ  tick volume (khÃ´ng pháº£i real volume), nhÆ°ng nghiÃªn cá»©u cho tháº¥y tick volume correlation vá»›i real volume trÃªn 90%.</p>`,
    80: `<h3>Maximum Favorable Excursion (MFE)</h3><p>MFE Ä‘o lÆ°á»ng má»©c lá»£i nhuáº­n lá»›n nháº¥t mÃ  má»—i lá»‡nh tá»«ng Ä‘áº¡t Ä‘Æ°á»£c trÆ°á»›c khi Ä‘Ã³ng. PhÃ¢n tÃ­ch MFE trong journal giÃºp tá»‘i Æ°u Take Profit. Náº¿u nhiá»u lá»‡nh tháº¯ng tá»«ng floating +50 pip nhÆ°ng TP chá»‰ +20 pip â†’ báº¡n Ä‘ang chá»‘t lá»i quÃ¡ sá»›m. NgÆ°á»£c láº¡i, Maximum Adverse Excursion (MAE) cho biáº¿t giÃ¡ Ä‘Ã£ Ä‘i ngÆ°á»£c tá»‘i Ä‘a bao nhiÃªu trÆ°á»›c khi hit TP. MAE giÃºp tá»‘i Æ°u Stop Loss: náº¿u háº§u háº¿t lá»‡nh tháº¯ng chá»‰ drawdown tá»‘i Ä‘a -15 pip, Ä‘áº·t SL -15 pip thay vÃ¬ -30 pip. CÃ¡c chá»‰ sá»‘ MFE/MAE chá»‰ cÃ³ Ä‘Æ°á»£c khi báº¡n backtest Ä‘áº§y Ä‘á»§ vá»›i Ã­t nháº¥t 100 máº«u.</p>`,
    81: `<h3>Automated vs Manual Backtest</h3><p>Manual backtest (dÃ¹ng Replay) cháº­m nhÆ°ng giÃºp báº¡n thá»±c sá»± "sá»‘ng" vá»›i chiáº¿n lÆ°á»£c. Báº¡n cáº£m nháº­n Ä‘Æ°á»£c thá»‹ trÆ°á»ng, tháº¥y nhá»¯ng lÃºc khÃ³ khÄƒn, vÃ  biáº¿t cáº£m giÃ¡c khi gáº·p chuá»—i 5 lá»‡nh thua. Automated backtest (dÃ¹ng Pine Script trÃªn TradingView hoáº·c EA trÃªn MT4) nhanh, test hÃ ng ngÃ n lá»‡nh trong vÃ i giÃ¢y, nhÆ°ng khÃ´ng cho báº¡n tráº£i nghiá»‡m tÃ¢m lÃ½. Lá»i khuyÃªn: báº¯t Ä‘áº§u manual backtest 100 lá»‡nh trÆ°á»›c, sau Ä‘Ã³ chuyá»ƒn sang automated Ä‘á»ƒ test trÃªn nhiá»u cáº·p tiá»n vÃ  timeframe. Káº¿t há»£p cáº£ hai cho káº¿t quáº£ toÃ n diá»‡n nháº¥t.</p>`,
    82: `<h3>Lá»™ trÃ¬nh cho ngÆ°á»i má»›i</h3><p>ThÃ¡ng 1-2: Chá»‰ trade EUR/USD trÃªn Demo. Há»c cÃ¡ch Ä‘áº·t lá»‡nh, Ä‘á»c biá»ƒu Ä‘á»“, vÃ  sá»­ dá»¥ng 1 chiáº¿n lÆ°á»£c Ä‘Æ¡n giáº£n. ThÃ¡ng 3-4: ThÃªm GBP/USD hoáº·c USD/JPY. So sÃ¡nh Ä‘áº·c Ä‘iá»ƒm vÃ  ghi journal. ThÃ¡ng 5-6: Náº¿u tá»· lá»‡ tháº¯ng á»•n Ä‘á»‹nh >45% vá»›i R:R >1.5:1 trÃªn demo â†’ chuyá»ƒn sang tiá»n tháº­t vá»›i micro lot. Quan trá»ng nháº¥t: khÃ´ng vá»™i. Trader vá»™i vÃ ng chuyá»ƒn tiá»n tháº­t sau 1-2 tuáº§n demo lÃ  nguyÃªn nhÃ¢n chÃ­nh khiáº¿n 90% trader thua lá»—. Äáº§u tÆ° 6 thÃ¡ng há»c trÃªn demo sáº½ save cho báº¡n hÃ ng ngÃ n Ä‘Ã´ trong tÆ°Æ¡ng lai.</p>`,
    83: `<h3>Digital Tools cho Journal</h3><p>NgoÃ i Google Sheets vÃ  Notion, cÃ³ nhiá»u cÃ´ng cá»¥ journal chuyÃªn biá»‡t. TradeZella tá»± import lá»‡nh tá»« MT4/MT5, phÃ¢n tÃ­ch setup, vÃ  táº¡o report tá»± Ä‘á»™ng - giÃ¡ $29/thÃ¡ng nhÆ°ng tiáº¿t kiá»‡m ráº¥t nhiá»u thá»i gian. Tradervue miá»…n phÃ­ cho 100 trade/thÃ¡ng, Ä‘á»§ cho háº§u háº¿t trader. Náº¿u dÃ¹ng Google Sheets, táº¡o Dashboard vá»›i chart P&L theo tuáº§n, Win Rate theo setup, vÃ  Drawdown chart. Google Sheets + Google App Script cÃ³ thá»ƒ tá»± Ä‘á»™ng tÃ­nh toÃ¡n má»i thá»©, gáº§n nhÆ° thay tháº¿ pháº§n má»m tráº£ phÃ­. Template miá»…n phÃ­ cÃ³ thá»ƒ tÃ¬m trÃªn tradingheroes.com hoáº·c babypips.com.</p>`,
    84: `<h3>Regulation vÃ  báº£o vá»‡ nhÃ  Ä‘áº§u tÆ°</h3><p>IC Markets Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi ASIC (Australia) - má»™t trong nhá»¯ng cÆ¡ quan tÃ i chÃ­nh nghiÃªm ngáº·t nháº¥t tháº¿ giá»›i. Tiá»n khÃ¡ch hÃ ng Ä‘Æ°á»£c giá»¯ tÃ¡ch biá»‡t táº¡i ngÃ¢n hÃ ng National Australia Bank. Exness cÃ³ FCA (Anh) vÃ  CySEC (SÃ­p), cÅ©ng lÃ  cÃ¡c cÆ¡ quan quáº£n lÃ½ hÃ ng Ä‘áº§u. Cáº£ hai sÃ n Ä‘á»u cung cáº¥p báº£o hiá»ƒm báº£o vá»‡ nhÃ  Ä‘áº§u tÆ°, nhÆ°ng má»©c báº£o vá»‡ khÃ¡c nhau tÃ¹y entity Ä‘Äƒng kÃ½. Trader Viá»‡t Nam thÆ°á»ng Ä‘Äƒng kÃ½ dÆ°á»›i entity offshore (FSA, SCB) nÃªn má»©c báº£o vá»‡ tháº¥p hÆ¡n so vá»›i Ä‘Äƒng kÃ½ trá»±c tiáº¿p táº¡i UK hay Australia.</p>`,
    85: `<h3>DÃ¹ng AI Ä‘á»c tin tá»©c</h3><p>Trong nÄƒm 2026, nhiá»u trader Ä‘Ã£ dÃ¹ng AI Ä‘á»ƒ phÃ¢n tÃ­ch tin tá»©c nhanh hÆ¡n. CÃ¡c cÃ´ng cá»¥ nhÆ° ForexGPT hoáº·c TradingView Pine Script cÃ³ thá»ƒ quÃ©t lá»‹ch kinh táº¿ vÃ  tÃ­nh toÃ¡n tÃ¡c Ä‘á»™ng tiá»m nÄƒng. Tuy nhiÃªn, AI chÆ°a thá»ƒ thay tháº¿ hoÃ n toÃ n phÃ¡n Ä‘oÃ¡n cá»§a trader kinh nghiá»‡m, Ä‘áº·c biá»‡t trong cÃ¡c sá»± kiá»‡n báº¥t ngá» (geopolitical risk, bank failure). Sá»­ dá»¥ng AI nhÆ° cÃ´ng cá»¥ há»— trá»£, khÃ´ng pháº£i thay tháº¿. Káº¿t há»£p Forex Factory + AI summary + kinh nghiá»‡m cÃ¡ nhÃ¢n lÃ  combo hiá»‡u quáº£ nháº¥t cho fundamental analysis.</p>`
};

async function main() {
    console.log('ğŸ“ Round 2: Bá»• sung thÃªm ná»™i dung...\n');
    for (const [id, extra] of Object.entries(extras)) {
        const { data: post } = await sb.from('posts').select('content').eq('id', Number(id)).single();
        if (!post) continue;
        let content = post.content;
        const lastH2 = content.lastIndexOf('<h2>');
        if (lastH2 > 0) content = content.slice(0, lastH2) + extra + content.slice(lastH2);
        else content += extra;
        const { error } = await sb.from('posts').update({ content, updated_at: new Date().toISOString() }).eq('id', Number(id));
        const text = content.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
        const words = text.split(' ').filter(w => w.length > 0).length;
        const st = words >= 900 ? 'âœ…' : 'âš ï¸';
        console.log(`${st} ID ${id} â†’ ${words} tá»«`);
    }
    console.log('\nâœ… Done!');
}
main();
